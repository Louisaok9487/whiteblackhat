<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Gray-Fox</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&display=swap');

        :root {
            --background-color: #0d0d0d;
            --text-color: #00ff41;
            --prompt-color: #00ff41;
            --input-color: #ffffff;
            --highlight-color: #faffa8;
            --error-color: #ff4d4d;
            --whitehat-color: #75aaff;
            --blackhat-color: #ff4d4d;
            --sidebar-bg: #1a1a1a;
            --sidebar-border: #333333;
            --button-bg: #333;
            --button-hover-bg: #444;
            --button-disabled-bg: #222;
            --button-disabled-color: #555;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            font-family: 'Inconsolata', monospace;
            font-size: 16px;
            line-height: 1.5;
            margin: 0;
            padding: 0;
            overflow: hidden;
            display: flex;
            height: 100vh;
        }
        
        #main-container {
            display: flex;
            width: 100%;
            height: 100%;
        }

        #terminal-container {
            flex-grow: 1;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            height: 100vh;
            box-sizing: border-box;
        }

        #terminal {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        #output {
            flex-grow: 1;
            overflow-y: auto;
            padding-right: 10px;
        }

        .input-line {
            display: flex;
            align-items: center;
        }

        .prompt {
            color: var(--prompt-color);
            margin-right: 0.5rem;
            white-space: nowrap;
        }

        #input {
            background-color: transparent;
            border: none;
            color: var(--input-color);
            font-family: inherit;
            font-size: inherit;
            width: 100%;
            outline: none;
        }

        .cursor {
            display: inline-block;
            width: 10px;
            height: 1.2em;
            background-color: var(--input-color);
            animation: blink 1s step-end infinite;
            vertical-align: bottom;
        }

        @keyframes blink {
            50% { background-color: transparent; }
        }

        /* --- Sidebar --- */
        #sidebar {
            width: 350px;
            min-width: 300px;
            background-color: var(--sidebar-bg);
            border-left: 2px solid var(--sidebar-border);
            padding: 1rem;
            overflow-y: auto;
            height: 100vh;
            box-sizing: border-box;
        }

        .sidebar-section {
            margin-bottom: 1.5rem;
            border: 1px solid var(--sidebar-border);
            border-radius: 5px;
            padding: 1rem;
        }
        .sidebar-section h3 {
            margin-top: 0;
            border-bottom: 1px solid var(--text-color);
            padding-bottom: 0.5rem;
            color: var(--text-color);
        }

        #status-display span, #heat-display span {
            display: block;
            margin-bottom: 0.5rem;
        }
        
        #heat-bar-container {
            width: 100%;
            height: 20px;
            background-color: #333;
            border-radius: 5px;
            overflow: hidden;
            border: 1px solid var(--sidebar-border);
        }
        #heat-bar {
            width: 0%;
            height: 100%;
            background-color: var(--error-color);
            transition: width 0.5s ease;
        }

        .shop-item, .faction-item {
            margin-bottom: 1rem;
            padding: 0.5rem;
            background-color: #2a2a2a;
            border-radius: 4px;
        }
        .shop-item p, .faction-item p {
            margin: 0 0 0.5rem 0;
            font-size: 0.9em;
            color: #ccc;
        }
        .shop-item button, .faction-item button {
            width: 100%;
            padding: 0.5rem;
            background-color: var(--button-bg);
            color: var(--text-color);
            border: 1px solid var(--text-color);
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
        }
        .shop-item button:hover, .faction-item button:hover {
            background-color: var(--button-hover-bg);
        }
        .shop-item button:disabled {
            background-color: var(--button-disabled-bg);
            color: var(--button-disabled-color);
            border-color: var(--button-disabled-color);
            cursor: not-allowed;
        }
        .owned-item {
            color: var(--highlight-color);
            font-weight: bold;
        }


        .error { color: var(--error-color); }
        .white-hat { color: var(--whitehat-color); }
        .black-hat { color: var(--blackhat-color); }
        .highlight {
            background-color: var(--text-color);
            color: var(--background-color);
            padding: 0 4px;
        }
    </style>
</head>
<body>

<div id="main-container">
    <div id="terminal-container">
        <div id="terminal">
            <div id="output"></div>
            <div class="input-line">
                <span class="prompt" id="prompt">gray-fox@local:~$</span>
                <input type="text" id="input" autofocus>
                <span class="cursor"></span>
            </div>
        </div>
    </div>
    <div id="sidebar">
        <div id="status-section" class="sidebar-section">
            <h3>Status</h3>
            <div id="status-display">
                 <span>💰 Money: $<span id="money">0</span></span>
                 <span>😇 White Hat: <span id="white-hat-rep">0</span></span>
                 <span>😈 Black Hat: <span id="black-hat-rep">0</span></span>
            </div>
             <div id="heat-display">
                <span>Heat Level:</span>
                <div id="heat-bar-container">
                    <div id="heat-bar"></div>
                </div>
            </div>
        </div>

        <div id="shop-section" class="sidebar-section">
            <h3>Hardware & Software Shop</h3>
            <div id="shop-items"></div>
        </div>

        <div id="faction-section" class="sidebar-section">
            <h3 id="faction-title">Faction Access</h3>
            <div id="faction-content">
                <p>Your reputation is not yet strong enough to attract the attention of major factions.</p>
            </div>
        </div>
    </div>
</div>


<script>
    // --- DOM Elements ---
    const terminal = document.getElementById('terminal');
    const output = document.getElementById('output');
    const input = document.getElementById('input');
    const promptEl = document.getElementById('prompt');
    const moneyEl = document.getElementById('money');
    const whiteHatRepEl = document.getElementById('white-hat-rep');
    const blackHatRepEl = document.getElementById('black-hat-rep');
    const heatBar = document.getElementById('heat-bar');
    const shopItemsContainer = document.getElementById('shop-items');
    const factionContent = document.getElementById('faction-content');
    const factionTitle = document.getElementById('faction-title');


    // --- Game State ---
    let commandHistory = [];
    let historyIndex = -1;
    let gameState = {
        money: 500, // Start with some seed money
        whiteHatRep: 0,
        blackHatRep: 0,
        heat: 0, // 0-100 scale
        currentMission: null,
        inMinigame: false,
        minigameCallback: null,
        upgrades: {
            cpuLevel: 1,
            ramLevel: 1,
            hasPremiumScanner: false,
            hasVpn: false,
            wordlistLevel: 1, // 1: basic, 2: rockyou
        },
        inventory: {
            zeroDayExploits: 0
        },
        // --- Mission Database ---
        missions: {
            // Missions now have a 'faction' property: 'neutral', 'white', 'black'
            // And a 'repRequirement'
            "mission_01": { id: "mission_01", faction: "white", repRequirement: 0, type: "sql_injection", title: "Vulnerability Assessment for OmniCorp", client: "OmniCorp", targetIp: "192.168.1.101", completed: false, mail: `...` },
            "mission_02": { id: "mission_02", faction: "white", repRequirement: 0, type: "social_engineering", title: "Employee Security Awareness Test", client: "CyberRight Inc.", target: "TechSolutions LLC", completed: false, mail: `...` },
            "mission_03": { id: "mission_03", faction: "black", repRequirement: 0, type: "data_theft", title: "Acquire Competitor's Project Files", client: "Anonymous", targetIp: "203.0.113.78", completed: false, mail: `...` },
            "mission_04": { id: "mission_04", faction: "white", repRequirement: 1, type: "wifi_cracking", title: "Coffee Shop WiFi Test", client: "The Daily Grind Cafe", target: "GrindNet_Guest", completed: false, mail: `...` },
            "mission_05": { id: "mission_05", faction: "white", repRequirement: 2, type: "phishing", title: "Corporate Phishing Drill", client: "Securitas Corp", target: "MegaCorp Inc.", completed: false, mail: `...` },
            "mission_06": { id: "mission_06", faction: "black", repRequirement: 2, type: "physical_hacking", title: "USB Drop", client: "Anonymous Client", target: "Rival Corp HQ", completed: false, mail: `...` },
            "mission_07": { id: "mission_07", faction: "white", repRequirement: 3, type: "network_sniffing", title: "Internal Data Leak Investigation", client: "Fintech Solutions", targetIp: "10.10.5.15", completed: false, mail: `...` },
            "mission_08": { id: "mission_08", faction: "white", repRequirement: 4, type: "ai_adversarial", title: "Test AI Security System", client: "Cerebrum AI", target: "Cerebrum GuardAI", completed: false, mail: `...` },
            "mission_09": { id: "mission_09", faction: "black", repRequirement: 3, type: "ransomware", title: "Ransomware Deployment", client: "DarkNet Syndicate", targetIp: "172.16.30.120", completed: false, mail: `...` },
            "mission_10": { id: "mission_10", faction: "black", repRequirement: 1, type: "dos_attack", title: "Tournament Disruption", client: "Salty Gamers Crew", targetIp: "198.51.100.45", completed: false, mail: `...` },
            "mission_11": { id: "mission_11", faction: "black", repRequirement: 4, type: "password_cracking", title: "Crack the Database", client: "Data Brokers Inc.", target: "leaked_db.hash", completed: false, mail: `...` },
            "mission_12": { id: "mission_12", faction: "black", repRequirement: 5, type: "mobile_hacking", title: "Targeted Surveillance", client: "Gov Agency [CLASSIFIED]", target: "Journalist", completed: false, mail: `...` },
            "mission_13": { id: "mission_13", faction: "white", repRequirement: 5, type: "cloud_hacking", title: "Cloud Storage Audit", client: "StartUp Innovations", target: "startup-innovations.com", completed: false, mail: `...` }
        }
    };
    // Fill in mission mail content (shortened for brevity in the state object)
    Object.values(gameState.missions).forEach(m => {
        const fullMission = getFullMissionDetails(m.id);
        m.mail = fullMission.mail;
    });


    // --- Shop & Faction Data ---
    const shopData = {
        'cpu2': { name: 'CPU Upgrade (Lvl 2)', cost: 2500, description: 'Speeds up cracking tasks.', type: 'upgrade', key: 'cpuLevel', value: 2 },
        'cpu3': { name: 'CPU Upgrade (Lvl 3)', cost: 10000, description: 'Dramatically speeds up cracking.', type: 'upgrade', key: 'cpuLevel', value: 3, requires: {key: 'cpuLevel', value: 2} },
        'scanner': { name: 'Premium Scanner', cost: 4000, description: 'Reveals hidden vulnerabilities.', type: 'upgrade', key: 'hasPremiumScanner', value: true },
        'wordlist2': { name: 'Advanced Wordlist', cost: 1500, description: 'Improves dictionary attacks.', type: 'upgrade', key: 'wordlistLevel', value: 2 },
        'vpn': { name: 'Anonymizer VPN', cost: 5000, description: 'Reduces Heat from black hat jobs.', type: 'upgrade', key: 'hasVpn', value: true },
    };

    const factionData = {
        white: {
            name: "Cybersecurity Alliance",
            items: {
                'intel': { name: 'Buy Mission Intel', cost: 2000, description: 'Get a hint for your current mission.' }
            }
        },
        black: {
            name: "The DarkNet",
            items: {
                'zeroday': { name: 'Buy Zero-Day Exploit', cost: 25000, description: 'A single-use, guaranteed exploit.' },
                'botnet': { name: 'Rent Botnet', cost: 7000, description: 'Boosts DoS attack effectiveness.' }
            }
        }
    }

    // --- Core Game Logic ---
    input.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
            const command = input.value.trim();
            if (command) {
                printToOutput(`<span class="prompt">${promptEl.textContent}</span> ${command}`);
                handleCommand(command);
                commandHistory.unshift(command);
                historyIndex = -1;
                input.value = '';
                scrollToBottom();
            }
        } else if (e.key === 'ArrowUp') {
            if (historyIndex < commandHistory.length - 1) { historyIndex++; input.value = commandHistory[historyIndex]; }
        } else if (e.key === 'ArrowDown') {
            if (historyIndex > 0) { historyIndex--; input.value = commandHistory[historyIndex]; } 
            else { historyIndex = -1; input.value = ''; }
        }
    });

    terminal.addEventListener('click', () => { input.focus(); });

    function handleCommand(command) {
        const [cmd, ...args] = command.toLowerCase().split(' ');

        if (cmd === 'help') { showHelp(); return; }
        if (cmd === 'clear') { output.innerHTML = ''; return; }
        
        if (gameState.inMinigame) {
            if (gameState.minigameCallback) gameState.minigameCallback(command);
            return;
        }

        switch (cmd) {
            case 'whoami': printToOutput('User: gray-fox 🧑‍💻'); break;
            case 'mail': checkMail(); break;
            case 'scan': runScan(args[0]); break;
            case 'exploit': runExploit(args[0], args[1]); break;
            case 'report': runReport(); break;
            case 'exploit_data': runExploitData(); break;
            case 'social_eng': startSocialEngineeringMinigame(args[0]); break;
            case 'scan_wifi': startWifiScan(); break;
            case 'crack_wpa2': startWifiCrack(args[0]); break;
            case 'craft_phish': startPhishingMinigame(); break;
            case 'infiltrate': startPhysicalHackingMinigame(args[0]); break;
            case 'sniff_traffic': startNetworkSniffing(args[0]); break;
            case 'access_ai_lab': startAiMinigame(); break;
            case 'initiate_botnet': startDosMinigame(); break;
            case 'crack_hashes': startPasswordCrack(args[0]); break;
            case 'develop_app': startMobileHacking(); break;
            case 'scan_cloud': startCloudScan(args[0]); break;
            default: printToOutput(`<span class="error">Command not found: ${cmd}. Type 'help' for a list of commands.</span>`);
        }
    }

    // --- Command Functions ---
    function showHelp() {
        const helpText = `
Project Gray-Fox Help:
  <span class="highlight">help</span>                 - Shows this help message.
  <span class="highlight">clear</span>                - Clears the terminal screen.
  <span class="highlight">whoami</span>               - Displays your current user.
  <span class="highlight">mail</span>                 - Checks for new messages and missions.
  <span class="highlight">scan [ip]</span>              - Scans a target IP for vulnerabilities.
  <span class="highlight">exploit [vuln]</span>         - Attempts to exploit a found vulnerability.
  <span class="highlight">report</span>                 - Report vulnerability to client (White Hat).
  <span class="highlight">exploit_data</span>           - Steal data for profit (Black Hat).

Mission-specific commands will be provided in mission briefings.
Check the sidebar on the right to purchase upgrades and access faction services.
        `;
        printToOutput(helpText.replace(/\n/g, '<br>'));
    }
    
    function checkMail() {
        if (gameState.currentMission) {
            printToOutput("You already have an active mission. Complete it first.");
            return;
        }

        // Filter missions based on reputation
        const dominantRep = gameState.whiteHatRep > gameState.blackHatRep ? 'white' : 'black';
        const repScore = Math.max(gameState.whiteHatRep, gameState.blackHatRep);

        const availableMissions = Object.values(gameState.missions).filter(m => 
            !m.completed &&
            m.repRequirement <= repScore &&
            (m.faction === dominantRep || m.faction === 'neutral')
        );

        if (availableMissions.length === 0) {
            printToOutput("No new messages matching your reputation. Try completing different types of jobs.");
            return;
        }

        const mission = availableMissions[Math.floor(Math.random() * availableMissions.length)];
        gameState.currentMission = mission.id;
        
        const mailText = `New Message (1):${mission.mail}`;
        typewriterEffect(mailText);
    }
    
    function runScan(targetIp) {
        // ... (scan logic can now be modified by upgrades)
        const mission = gameState.missions[gameState.currentMission];
        if (!mission) { /*...*/ return; }
        if (targetIp !== mission.targetIp) { /*...*/ return; }

        let scanText = `Scanning ${targetIp} with scanner v${gameState.upgrades.cpuLevel}.0...`;
        
        // Example of upgrade integration
        if(gameState.upgrades.hasPremiumScanner) {
            scanText += `\n<span class="white-hat">[Premium Scanner]: Deep scan enabled.</span>`
        }
        
        // ... rest of the scan logic ...
        if (mission.type === 'sql_injection') {
            scanText += `\n[!] Potential SQL Injection vulnerability detected on login form!`;
        } else if (mission.type === 'ransomware') {
             scanText += `\n[!] Found an unpatched SMBv1 vulnerability (EternalBlue).`;
             if(gameState.upgrades.hasPremiumScanner) {
                 scanText += `\n<span class="white-hat">[Premium Scanner]: Also found an exposed RDP port (3389).</span>`;
             }
        } else {
             scanText += `\nNo obvious vulnerabilities found.`;
        }
        typewriterEffect(scanText);
    }

    function completeMission(money, whiteHat, blackHat) {
        gameState.money += money;
        gameState.whiteHatRep += whiteHat;
        gameState.blackHatRep += blackHat;
        
        if (blackHat > 0) {
            let heatIncrease = 15;
            if(gameState.upgrades.hasVpn) {
                heatIncrease = 5; // VPN reduces heat
                printToOutput(`<span class="white-hat">Anonymizer VPN routed traffic, heat reduced.</span>`);
            }
            gameState.heat = Math.min(100, gameState.heat + heatIncrease);
        } else if (whiteHat > 0) {
            gameState.heat = Math.max(0, gameState.heat - 5); // White hat jobs cool you down
        }
        
        if(gameState.currentMission) {
            gameState.missions[gameState.currentMission].completed = true;
            gameState.currentMission = null;
        }
        
        printToOutput("<br>Mission Completed! Check 'mail' for new assignments.");
        updateSidebar();
        checkHeat();
    }
    
    // ... other command functions (runExploit, runReport, etc.) remain largely the same ...
    // They will call completeMission which now handles reputation and heat.

    // --- Sidebar & Shop Logic ---

    function updateSidebar() {
        // Update Status
        moneyEl.textContent = gameState.money.toLocaleString();
        whiteHatRepEl.textContent = gameState.whiteHatRep;
        blackHatRepEl.textContent = gameState.blackHatRep;
        heatBar.style.width = `${gameState.heat}%`;

        // Update Shop
        shopItemsContainer.innerHTML = '';
        for (const id in shopData) {
            const item = shopData[id];
            const isOwned = gameState.upgrades[item.key] >= item.value;
            const canAfford = gameState.money >= item.cost;
            const meetsRequirement = !item.requires || (gameState.upgrades[item.requires.key] >= item.requires.value);

            const itemDiv = document.createElement('div');
            itemDiv.className = 'shop-item';
            
            let html = `<strong>${item.name}</strong>`;
            if (isOwned) {
                html += ` <span class="owned-item">[OWNED]</span>`;
            } else {
                html += ` - <span class="highlight">$${item.cost.toLocaleString()}</span>`;
            }
            html += `<p>${item.description}</p>`;
            
            const buyButton = document.createElement('button');
            buyButton.textContent = 'Buy';
            buyButton.disabled = isOwned || !canAfford || !meetsRequirement;
            if (!meetsRequirement) {
                buyButton.textContent = 'Requirement not met';
            }
            buyButton.onclick = () => buyItem(id, 'shop');

            itemDiv.innerHTML = html;
            if(!isOwned) itemDiv.appendChild(buyButton);
            shopItemsContainer.appendChild(itemDiv);
        }

        // Update Factions
        const whRep = gameState.whiteHatRep;
        const bhRep = gameState.blackHatRep;
        let activeFaction = null;

        if (whRep > bhRep && whRep >= 3) {
            activeFaction = 'white';
        } else if (bhRep > whRep && bhRep >= 3) {
            activeFaction = 'black';
        }

        if (activeFaction) {
            const data = factionData[activeFaction];
            factionTitle.textContent = data.name;
            factionContent.innerHTML = '';
            for (const id in data.items) {
                const item = data.items[id];
                const canAfford = gameState.money >= item.cost;
                const itemDiv = document.createElement('div');
                itemDiv.className = 'faction-item';
                itemDiv.innerHTML = `
                    <strong>${item.name}</strong> - <span class="highlight">$${item.cost.toLocaleString()}</span>
                    <p>${item.description}</p>
                    <button ${!canAfford ? 'disabled' : ''} onclick="buyItem('${id}', '${activeFaction}')">Purchase</button>
                `;
                factionContent.appendChild(itemDiv);
            }
        } else {
            factionTitle.textContent = 'Faction Access';
            factionContent.innerHTML = '<p>Your reputation is not yet strong enough to attract the attention of major factions.</p>';
        }
    }

    function buyItem(itemId, type) {
        const item = type === 'shop' ? shopData[itemId] : factionData[type].items[itemId];
        if (!item || gameState.money < item.cost) {
            printToOutput(`<span class="error">Purchase failed. Insufficient funds.</span>`);
            return;
        }

        gameState.money -= item.cost;
        
        if (item.type === 'upgrade') {
            gameState.upgrades[item.key] = item.value;
        } else {
            // Handle faction items/consumables
            switch(itemId) {
                case 'zeroday':
                    gameState.inventory.zeroDayExploits++;
                    break;
                // other faction items
            }
        }

        printToOutput(`Purchase successful: <span class="highlight">${item.name}</span>`);
        updateSidebar();
    }
    
    function checkHeat() {
        if (gameState.heat > 80 && Math.random() < 0.25) {
            typewriterEffect(`<span class="error">** ALERT ** Unusual network traffic detected on your connection! The Feds might be closing in. Lay low for a while.</span>`);
        }
    }

    // --- Helper Functions ---
    function printToOutput(html) {
        output.innerHTML += `<div>${html}</div>`;
        scrollToBottom();
    }

    function scrollToBottom() {
        output.scrollTop = output.scrollHeight;
    }
    
    function typewriterEffect(text, onComplete) {
        const lines = text.replace(/^\n+/, '').replace(/\n/g, '<br>').split('<br>');
        let lineIndex = 0;
        input.disabled = true;

        function printLine() {
            if (lineIndex < lines.length) {
                printToOutput(lines[lineIndex]);
                lineIndex++;
                setTimeout(printLine, 50 + Math.random() * 50);
            } else {
                input.disabled = false;
                input.focus();
                if (onComplete) onComplete();
            }
        }
        printLine();
    }

    // --- Game Start ---
    function startGame() {
        const welcomeMessage = `
Booting Gray-Fox OS v3.0...
Kernel loaded.
Hardware monitor initialized.
Network connection secured... OK

Welcome, Gray-Fox 🧑‍💻

Type <span class="highlight">help</span> for a list of available commands.
Type <span class="highlight">mail</span> to check for assignments.
        `;
        updateSidebar();
        typewriterEffect(welcomeMessage);
    }
    
    // Helper to get full mission text, which was removed from the main state object for clarity
    function getFullMissionDetails(id) {
        // In a real app, this might be a larger data structure or API call.
        // For now, we'll just store the original mail content here.
        const missionMails = {
            "mission_01": { mail: `\nFrom: contact@omnicorp.sec\nTo: gray-fox\nSubject: Urgent: Security Assessment Required\n\nWe require your services for a penetration test on one of our web servers. We suspect a potential vulnerability in our login system.\nTarget IP: <span class="highlight">192.168.1.101</span>\nYour task is to assess the system and report any findings.\n`},
            "mission_02": { mail: `\nFrom: security@cyberright.inc\nTo: gray-fox\nSubject: Contract: Social Engineering Test\n\nGray-Fox, we need you to test the human element at TechSolutions LLC.\nYour task is to acquire an admin password via phone (vishing).\nTarget: TechSolutions Help Desk.\nUse command <span class="highlight">social_eng TSL_HelpDesk</span> to initiate the call.\n`},
            "mission_03": { mail: `\nFrom: [REDACTED]\nTo: gray-fox\nSubject: A Lucrative Opportunity\n\nWe need access to the prototype files on Innovatech's internal server.\nTheir security is weak. Get in, get the files, get out.\nIP: <span class="highlight">203.0.113.78</span>\nDiscretion is key. Payment will be substantial.\n`},
            "mission_04": { mail: `\nFrom: owner@dailygrind.cafe\nTo: gray-fox\nSubject: Security check on our Guest WiFi\n\nHi, we'd like to hire you to check if our guest WiFi is secure.\nThe network name is <span class="highlight">GrindNet_Guest</span>.\nPlease see if you can get the password and let us know.\nUse <span class="highlight">scan_wifi</span> to begin.\n`},
            "mission_05": { mail: `\nFrom: audit@securitas.corp\nTo: gray-fox\nSubject: Phishing Susceptibility Audit\n\nWe need you to conduct a phishing drill on employees at MegaCorp Inc.\nYour goal is to see how many credentials you can capture.\nUse <span class="highlight">craft_phish</span> to design the attack email.\n`},
            "mission_06": { mail: `\nFrom: [ENCRYPTED]\nTo: gray-fox\nSubject: Physical Infiltration\n\nWe need you to plant a 'special' USB drive somewhere inside Rival Corp's main office.\nSomeone is bound to pick it up. The drive will do the rest.\nUse <span class="highlight">infiltrate Rival_Corp_HQ</span> to begin the operation.\n`},
            "mission_07": { mail: `\nFrom: cso@fintech.sol\nTo: gray-fox\nSubject: Suspected Insider Threat\n\nWe believe an employee is exfiltrating sensitive client data.\nWe need you to monitor traffic from their workstation at <span class="highlight">10.10.5.15</span> and find proof.\nUse <span class="highlight">sniff_traffic 10.10.5.15</span> to start monitoring.\n`},
            "mission_08": { mail: `\nFrom: labs@cerebrum.ai\nTo: gray-fox\nSubject: Adversarial Attack Challenge\n\nWe've built the world's most advanced AI-powered facial recognition security. We challenge you to fool it.\nYour task is to get past our system by making it misclassify you.\nUse <span class="highlight">access_ai_lab</span> to begin the test.\n`},
            "mission_09": { mail: `\nFrom: syndicate-boss@darknet.onion\nTo: gray-fox\nSubject: Job Offer: High Reward\n\nA local clinic has weak security. A perfect target.\nDeploy our ransomware on their server at <span class="highlight">172.16.30.120</span>.\nThe payout will be huge. Use <span class="highlight">scan [ip]</span> to find an entry point.\n`},
            "mission_10": { mail: `\nFrom: l33th4x@saltygamers.net\nTo: gray-fox\nSubject: Take 'em down!\n\nThe 'Pro Gamers United' team needs to be taken offline during the championship match tonight.\nTheir game server is at <span class="highlight">198.51.100.45</span>.\nWe'll pay you well to flood their server.\nUse <span class="highlight">initiate_botnet</span> to get started.\n`},
            "mission_11": { mail: `\nFrom: acquisitions@databrokers.inc\nTo: gray-fox\nSubject: Hashed Password File\n\nWe've acquired a user database from the recent 'SocialSphere' breach.\nThe passwords are all hashed. We need you to crack them.\nThe file is named <span class="highlight">leaked_db.hash</span>.\nUse <span class="highlight">crack_hashes leaked_db.hash</span> to begin.\n`},
            "mission_12": { mail: `\nFrom: agent.k@gov.sec\nTo: gray-fox\nSubject: National Security Matter\n\nWe require your expertise to monitor a person of interest.\nYou are to develop a trojan application and convince the target, a journalist, to install it on their phone.\nUse <span class="highlight">develop_app</span> to start.\n`},
            "mission_13": { mail: `\nFrom: ceo@startup-innovations.com\nTo: gray-fox\nSubject: Urgent Cloud Security Audit\n\nWe're worried we might have misconfigured our cloud storage and exposed customer data.\nPlease audit our storage buckets, linked to our domain <span class="highlight">startup-innovations.com</span>.\nUse <span class="highlight">scan_cloud startup-innovations.com</span> to check for open buckets.\n`}
        };
        return missionMails[id] || { mail: "Error: Mail not found." };
    }
    
    // Dummy functions for unimplemented commands/minigames
    const unimplemented = () => typewriterEffect(`<span class="error">This path is still under development.</span>`, () => completeMission(0,0,0));
    const startWifiCrack = unimplemented, startPhysicalHackingMinigame = unimplemented, startNetworkSniffing = unimplemented, startAiMinigame = unimplemented, startDosMinigame = unimplemented, startPasswordCrack = unimplemented, startMobileHacking = unimplemented, startCloudScan = unimplemented, startPhishingMinigame = unimplemented;
    const runReport = () => typewriterEffect(`Generating report...`, () => completeMission(5000, 1, 0));
    const runExploitData = () => typewriterEffect(`Exploiting data...`, () => completeMission(15000, 0, 1));
    const runExploit = unimplemented;
    const startSocialEngineeringMinigame = unimplemented;
    const startSqlInjectionMinigame = unimplemented;
    // ---

    startGame();
</script>
</body>
</html>
